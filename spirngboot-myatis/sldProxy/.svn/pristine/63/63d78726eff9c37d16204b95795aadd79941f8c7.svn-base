package com.ule.uhj.provider.yitu.service;

import java.util.HashMap;
import java.util.Map;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.util.EntityUtils;
import org.codehaus.jackson.JsonParseException;
import org.codehaus.jackson.map.ObjectMapper;

import com.alibaba.fastjson.JSONObject;
import com.ule.uhj.provider.yitu.util.HttpUtils;
import com.ule.uhj.sld.util.Convert;
import com.ule.uhj.sldProxy.util.Check;
import com.ule.uhj.sldProxy.util.PropertiesHelper;

public class BaiDuMapService {
	 protected static Log log = LogFactory.getLog(BaiDuMapService.class);
	 
	 private static String url=PropertiesHelper.getDfs("BD_GPS_QUERY_URL");
	 
	 private static String ak = PropertiesHelper.getDfs("ak");

	 public static String queryBDGpsInfo(Map<String,Object> param)throws Exception {
		 log.info("queryBDGpsInfo location:"+Convert.toStr(param.get("location")));
		 Map<String,Object> paramMap = new HashMap<String, Object>();
		paramMap.put("ak", ak);
		paramMap.put("location", Convert.toStr(param.get("location")));
		paramMap.put("output", "json");
		paramMap.put("qq-pf-to", "pcqq.c2c");
		log.info("queryBDGpsInfo paramMap:"+paramMap);
		HttpResponse response = HttpUtils.doGet(url, paramMap);
	    HttpEntity entity = response.getEntity();
		if(200 != response.getStatusLine().getStatusCode() || Check.isBlank(entity)){
			log.info(String.format("response code:%s, response entity:%s", new Object[]{response.getStatusLine().getStatusCode(), entity}));
    	}
    	String entityStr = EntityUtils.toString(entity);
    	log.info("queryBDGpsInfo entityStr:"+entityStr);
    	return entityStr;
	 }
	 
	 public static void main(String[] args) throws Exception {
		 Map<String,Object> param =new HashMap<String, Object>();
		 param.put("location", "31.2529,121.5710");
		 queryBDGpsInfo(param);
	}
}
